"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),WebBook=function(){function t(e,i){var s=this;_classCallCheck(this,t),this._bookContainer=e,this._textContainer=e.querySelector("[data-wb-text-container]"),this._text=e.querySelector("[data-wb-text]"),this._height=i.height,this._width=i.maxWidth,this._marginX=void 0===i.marginX?30:i.marginX,this._marginY=void 0===i.marginY?20:i.marginY,this._position=0,this.col=!0,this._bookmark=null,this._containerWidth=null,this._lastBreak=document.createElement("div"),this._lastBreak.className="wb-text-break",this._text.appendChild(this._lastBreak),this._lastElement=document.createElement("div"),this._lastElement.innerHTML="&nbsp;",this._lastElement.className="wb-section wb-no-toc",this._lastBreak.id="lastelement",this._text.appendChild(this._lastElement),this._sections=this._text.querySelectorAll(".wb-section"),this._tocSections=[];for(var n=0;n<this._sections.length;n++)this._sections[n].className.match(/wb-no-toc/)||this._tocSections.push(this._sections[n]);this._breaks=this._text.querySelectorAll(".wb-text-break"),this._elements=this._text.querySelectorAll(":not(.wb-text-break)"),this._tocs=this._bookContainer.querySelectorAll("[data-wb-toc]"),this.getToc(),this._currentPages=this._bookContainer.querySelectorAll(".wb-current-page"),this._totalPages=this._bookContainer.querySelectorAll(".wb-total-pages"),this._currentTotalPages=this._bookContainer.querySelectorAll(".wb-currentByTotal-pages"),this._elPageNumbers=this._bookContainer.querySelectorAll("[data-wb-element-page-number]"),this._sectionTitles=this._bookContainer.querySelectorAll(".wb-current-section-title"),this._startPage=null;for(var o=this._bookContainer.querySelectorAll(".wb-link"),a=0;a<o.length;a++)o[a].addEventListener("click",function(t){if(!0===s.col){t.preventDefault();var e=t.currentTarget.getAttribute("href").replace(/^#/,"");s.goToPage(s.elementPageNumber(e))}},!1);"WebkitColumnWidth"in document.body.style||"MozColumnWidth"in document.body.style||"columnWidth"in document.body.style?this.toBook():this.toScroll()}return _createClass(t,[{key:"toBook",value:function(){if("webkitColumnWidth"in document.body.style||"MozColumnWidth"in document.body.style||"columnWidth"in document.body.style){this.col=!0;var t=this._textContainer.style,e=this._text.style;t.position="relative",t.padding="0px",t.height=this.getHeight()+"px",t.maxWidth=this.getMaxWidth()+"px",this._containerWidth=this._textContainer.clientWidth;for(var i=0;i<this._sections.length;i++)"10%"!==this._sections[i].style.minHeight&&(this._sections[i].style.minHeight="10%");for(var s=0;s<this._breaks.length;s++)"300%"!==this._breaks[s].style.marginBottom&&(this._breaks[s].style.marginBottom="300%");"300%"!==this._lastElement.style.marginBottom&&(this._lastElement.style.marginBottom="300%"),e.webkitColumnWidth=this._containerWidth+"px",e.MozColumnWidth=this._containerWidth+"px",e.columnWidth=this._containerWidth+"px",e.MozColumnGap=2*this.getMarginX()+"px",e.webkitColumnGap=2*this.getMarginX()+"px",e.columnGap=2*this.getMarginX()+"px",e.MozColumnFill="auto",e.columnFill="auto",e.height="100%",e.width="100%",e.paddingRight=this.getMarginX()+"px",e.paddingLeft=this.getMarginX()+"px",e.paddingTop=this.getMarginY()+"px",e.paddingBottom=this.getMarginY()+"px",e.position="absolute",e.left=0,e.top=0,t.overflow="hidden",console.log($("[data-wb-text]").position());var n=$("#lastelement").position();console.log(n),console.log(this._lastElement.offsetLeft),this._bookmark&&(this.goToBookmark(this._bookmark),this._position=this._text.offsetLeft),this.refresh()}}},{key:"toScroll",value:function(){this.col=!1;var t=this._container.style,e=this._text.style;t.height="auto",t.maxWidth=this.getMaxWidth()+"px",t.overflow="visible",e.position="static",e.height="auto",t.paddingRight=this.getMarginX()+"px",t.paddingLeft=this.getMarginX()+"px",t.paddingTop=this.getMarginY()+"px",t.paddingBottom=this.getMarginY()+"px",("webkitColumnWidth"in document.body.style||"MozColumnWidth"in document.body.style||"columnWidth"in document.body.style)&&(e.webkitColumns="auto 1",e.MozColumns="auto 1",e.columns="auto 1");for(var i=0;i<this._sections.length;i++)this._sections[i].style.minHeight="0";for(var s=0;s<this._breaks.length;s++)this._breaks[s].style.marginBottom="0";this._lastElement.style.marginBottom="0px",this.refresh()}},{key:"setMaxWidth",value:function(t){return this._width=t,this}},{key:"getMaxWidth",value:function(){return this._width}},{key:"setHeight",value:function(t){return this._height=t,this}},{key:"getHeight",value:function(){return this._height}},{key:"setMarginX",value:function(t){return this._marginX=t,this}},{key:"getMarginX",value:function(){return this._marginX}},{key:"setMarginY",value:function(t){return this._marginY=t,this}},{key:"getMarginY",value:function(){return this._marginY}},{key:"forward",value:function(){this._lastElement.offsetLeft+this._position>this._containerWidth+this.getMarginX()&&(this._position=this._text.offsetLeft,this._position-=this._containerWidth,this._text.style.left=this._position+"px",this.refresh())}},{key:"backward",value:function(){this._position<0&&(this._position=this._text.offsetLeft,this._position+=this._containerWidth,this._text.style.left=this._position+"px",this.refresh())}},{key:"toFirstPage",value:function(){this._position<0&&(this._position=0,this._text.style.left=this._position+"px",this.refresh())}},{key:"toLastPage",value:function(){this._lastElement.offsetLeft+this._position>this._containerWidth+this.getMarginX()&&(this._position=this._containerWidth+this.getMarginX()-this._lastElement.offsetLeft,this._text.style.left=this._position+"px",this.refresh())}},{key:"getPageStart",value:function(){for(var t=void 0,e=void 0,i=0;i<this._sections.length-1;i++)if(this._sections[i].className.match(/wb-no-page/))t=i;else if(void 0!==t&&void 0===e){e=i;var s=this._sections[e].offsetLeft-this.getMarginX();s=s%this._containerWidth!=0?s-s%this._containerWidth:s,this._startPage=s/this._containerWidth}}},{key:"checkFirstPage",value:function(){return 0===this._position}},{key:"getPageNumber",value:function(){var t=Math.abs(Math.floor(this._position/this._containerWidth))+1;return t-=this._startPage}},{key:"getTotalPages",value:function(){var t=Math.floor(this._lastElement.offsetLeft/this._containerWidth);return t-=this._startPage}},{key:"goToPage",value:function(t){t=(t=t<1-this._startPage?1-this._startPage:t)>this.getTotalPages()?this.getTotalPages():t,t+=this._startPage;var e=this._containerWidth*(t-1);this._text.style.left=-e+"px",this._position=this._text.offsetLeft,this.refresh()}},{key:"elementPageNumber",value:function(t){var e=this._text.querySelector("#"+t).offsetLeft-this.getMarginX(),i=(e=e%this._containerWidth!=0?e-e%this._containerWidth:e)/this._containerWidth+1;return i-=this._startPage}},{key:"getSectionTitle",value:function(){for(var t=-this._position,e=void 0,i=1;i<this._sections.length;i++)if(this._sections[i].offsetLeft-this._containerWidth>=t){var s=this._sections[i-1].id;e=void 0!==s&&this.getPageNumber()===this.elementPageNumber(s)?"":this._sections[i-1].getAttribute("data-wb-title")?this._sections[i-1].getAttribute("data-wb-title"):this._sections[i-1].title;break}return e}},{key:"getToc",value:function(){if(0!==this._tocs.length)for(var t=0;t<this._tocs.length;t++){var e=this._tocs[t];if(e.getAttribute("data-wb-toc")){var i=document.createElement("p");i.setAttribute("class","wb-toc-title"),i.innerHTML=e.getAttribute("data-wb-toc"),e.appendChild(i)}var s=document.createElement("ul");s.setAttribute("class","wb-toc-list");for(var n=0;n<this._sections.length;n++){var o=this._sections[n];if(!o.className.match(/wb-no-toc/)){var a=document.createElement("li");if(a.setAttribute("class","wb-toc-item"),o.className.match(/wb-toc-no-page-number/)){var r=document.createElement("span");r.setAttribute("class","wb-toc-item-title"),r.innerHTML=o.getAttribute("data-wb-title-toc")?o.getAttribute("data-wb-title-toc"):o.title,a.appendChild(r)}else{var h=document.createElement("a");h.setAttribute("href","#"+o.id),h.setAttribute("class","wb-link"),a.appendChild(h);var l=document.createElement("span");l.setAttribute("class","wb-toc-item-title"),l.innerHTML=o.getAttribute("data-wb-title-toc")?o.getAttribute("data-wb-title-toc"):o.title,h.appendChild(l);var c=document.createElement("span");c.setAttribute("class","wb-toc-item-page-number"),c.setAttribute("data-wb-element-page-number",o.id),h.appendChild(c)}s.appendChild(a)}}e.appendChild(s)}}},{key:"getTocCurrentSection",value:function(){var t=-this._position;this._tocSections.push(this._lastElement),this._sections[0].className.match(/wb-no-toc/)&&this._tocSections.unshift(this._sections[0]);for(var e=0;e<this._tocs.length;e++)for(var i=this._tocs[e],s=1;s<this._tocSections.length;s++)if(this._tocSections[s].offsetLeft-this._containerWidth>=t){for(var n=this._tocSections[s-1].id,o=i.querySelectorAll("a"),a=0;a<o.length;a++){var r=o[a];r.getAttribute("href").replace(/^#/,"")===n?r.parentElement.className.match(/current/)||(r.parentElement.className+=" current"):r.parentElement.className.match(/current/)&&(r.parentElement.className=r.parentElement.className.replace(/ current/,""))}break}this._tocSections.pop(this._lastElement),this._sections[0].className.match(/wb-no-toc/)&&this._tocSections.shift(this._sections[0])}},{key:"insertBookmark",value:function(){for(var t=null,e=0;e<this._elements.length;e++){var i=this._elements[e].offsetLeft-this.getMarginX();if((i=i%this._containerWidth!=0?i-i%this._containerWidth:i)===-this._position){t=e;break}if(i>-this._position){t=e-1;break}}this._bookmark=t}},{key:"goToBookmark",value:function(t){var e=this._elements[this._bookmark].offsetLeft-this.getMarginX();e=e%this._containerWidth!=0?e-e%this._containerWidth:e,this._text.style.left=-e+"px",this._position=this._text.offsetLeft,this.refresh()}},{key:"refresh",value:function(){if(this.insertBookmark(),!1===this.col){for(var t=0;t<this._currentPages.length;t++)this._currentPages[t].innerHTML="";for(var e=0;e<this._totalPages.length;e++)this._totalPages[e].innerHTML="";for(var i=0;i<this._currentTotalPages.length;i++)this._currentTotalPages[i].innerHTML="";for(var s=0;s<this._elPageNumbers.length;s++)this._elPageNumbers[s].innerHTML="";for(var n=0;n<this._sectionTitles.length;n++)this._sectionTitles[n].innerHTML=""}else{this.getPageStart(),0!==this._tocs.length&&this.getTocCurrentSection();for(var o=0;o<this._currentPages.length;o++)this._currentPages[o].innerHTML!=this.getPageNumber()&&(this._currentPages[o].innerHTML=this.getPageNumber());for(var a=0;a<this._totalPages.length;a++)this._totalPages[a].innerHTML!=this.getPageNumber()&&(this._totalPages[a].innerHTML=this.getPageNumber());for(var r=0;r<this._currentTotalPages.length;r++)this.getPageNumber()<1?this._currentTotalPages[r].innerHTML="":this._currentTotalPages[r].innerHTML!==this.getPageNumber()+"/"+this.getTotalPages()&&(this._currentTotalPages[r].innerHTML=this.getPageNumber()+"/"+this.getTotalPages());for(var h=0;h<this._elPageNumbers.length;h++){var l=this._elPageNumbers[h].getAttribute("data-wb-element-page-number"),c=this.elementPageNumber(l);c<1?this._elPageNumbers[h].innerHTML="":this._elPageNumbers[h].innerHTML!=c&&(this._elPageNumbers[h].innerHTML=c)}for(var g=0;g<this._sectionTitles.length;g++)this._sectionTitles[g].innerHTML!=this.getSectionTitle()&&(this._sectionTitles[g].innerHTML=this.getSectionTitle())}}}]),t}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYi1ib29rLmpzIl0sIm5hbWVzIjpbIldlYkJvb2siLCJib29rQ29udGFpbmVyIiwib3B0aW9ucyIsIl90aGlzIiwidGhpcyIsIl9jbGFzc0NhbGxDaGVjayIsIl9ib29rQ29udGFpbmVyIiwiX3RleHRDb250YWluZXIiLCJxdWVyeVNlbGVjdG9yIiwiX3RleHQiLCJfaGVpZ2h0IiwiX3dpZHRoIiwibWF4V2lkdGgiLCJfbWFyZ2luWCIsInVuZGVmaW5lZCIsIm1hcmdpblgiLCJfbWFyZ2luWSIsIm1hcmdpblkiLCJfcG9zaXRpb24iLCJoZWlnaHQiLCJfbGFzdEVsZW1lbnQiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJpbm5lckhUTUwiLCJjb2wiLCJjbGFzc05hbWUiLCJfYm9va21hcmsiLCJpZCIsIl9jb250YWluZXJXaWR0aCIsIl9sYXN0QnJlYWsiLCJpIiwiX3NlY3Rpb25zIiwibGVuZ3RoIiwiX2JyZWFrcyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJfZWxlbWVudHMiLCJfdG9jcyIsImdldFRvYyIsIl9jdXJyZW50UGFnZXMiLCJfdG90YWxQYWdlcyIsIl9lbFBhZ2VOdW1iZXJzIiwibGlua3MiLCJfY3VycmVudFRvdGFsUGFnZXMiLCJlIiwiX3NlY3Rpb25UaXRsZXMiLCJyZXBsYWNlIiwiX3N0YXJ0UGFnZSIsImVsZW1lbnRQYWdlTnVtYmVyIiwiYm9keSIsInN0eWxlIiwicHJldmVudERlZmF1bHQiLCJ0b1Njcm9sbCIsInRvQm9vayIsImNzIiwidHMiLCJwb3NpdGlvbiIsInBhZGRpbmciLCJnZXRIZWlnaHQiLCJnZXRNYXhXaWR0aCIsImNsaWVudFdpZHRoIiwibWluSGVpZ2h0IiwibWFyZ2luQm90dG9tIiwid2Via2l0Q29sdW1uV2lkdGgiLCJNb3pDb2x1bW5XaWR0aCIsImNvbHVtbldpZHRoIiwiTW96Q29sdW1uR2FwIiwid2Via2l0Q29sdW1uR2FwIiwiY29sdW1uR2FwIiwiZ2V0TWFyZ2luWCIsIk1vekNvbHVtbkZpbGwiLCJjb2x1bW5GaWxsIiwid2lkdGgiLCJnZXRNYXJnaW5ZIiwicGFkZGluZ0xlZnQiLCJwYWRkaW5nVG9wIiwiJCIsInBhZGRpbmdCb3R0b20iLCJvZmZzZXRMZWZ0Iiwib3ZlcmZsb3ciLCJjb25zb2xlIiwiX2NvbnRhaW5lciIsInBhZGRpbmdSaWdodCIsImNvbHVtbnMiLCJ3ZWJraXRDb2x1bW5zIiwiTW96Q29sdW1ucyIsInJlZnJlc2giLCJ3IiwiaCIsIm0iLCJsZWZ0IiwiaW5kZXgiLCJzdGFydEluZGV4IiwibWF0Y2giLCJlbFBvc2l0aW9uIiwicGFnZU51bWJlciIsImFicyIsIk1hdGgiLCJmbG9vciIsInRvdGFsUGFnZXMiLCJudW1iZXIiLCJnZXRUb3RhbFBhZ2VzIiwiY2hlY2siLCJlbFBhZ2VOdW1iZXIiLCJ0aXRsZSIsImdldFBhZ2VOdW1iZXIiLCJnZXRBdHRyaWJ1dGUiLCJlbCIsInRvYyIsInRvY1RpdGxlIiwiYXBwZW5kQ2hpbGQiLCJsaXN0Iiwic2V0QXR0cmlidXRlIiwiaiIsIml0ZW0iLCJzZWN0aW9uIiwibGluayIsInBhZ2UiLCJfdG9jU2VjdGlvbnMiLCJwYXJlbnRFbGVtZW50IiwicG9wIiwic2hpZnQiLCJib29rbWFyayIsInVuc2hpZnQiLCJpbnNlcnRCb29rbWFyayIsImVsZW1lbnQiLCJnZXRUb2NDdXJyZW50U2VjdGlvbiIsImdldFBhZ2VTdGFydCIsImdldFNlY3Rpb25UaXRsZSJdLCJtYXBwaW5ncyI6IjZYQUFNQSxtQkFDTCxTQUFBQSxFQUFZQyxFQUFlQyxHQUFTLElBQUFDLEVBQUFDLEtBQUFDLGdCQUFBRCxLQUFBSixHQUVuQ0ksS0FBS0UsZUFBaUJMLEVBQ3RCRyxLQUFLRyxlQUFpQk4sRUFBY08sY0FBYyw0QkFDbERKLEtBQUtLLE1BQVFSLEVBQWNPLGNBQWMsa0JBSjFDSixLQUFBTSxRQUFBUixFQUFZRCxPQUF3QkcsS0FBQU8sT0FBQVQsRUFBQVUsU0FRbkNSLEtBQUtTLGNBQTZCQyxJQUFsQlosRUFBUWEsUUFBc0IsR0FBS2IsRUFBUWEsUUFSeEJYLEtB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QyxtQkFBbUJaLEdBQUdQLFVBQVluQixLQUFLb0csZ0JBQWtCLElBQU1wRyxLQUFLZ0csaUJBSTNFLElBQUksSUFBSXRFLEVBQUUsRUFBR0EsRUFBRTFCLEtBQUtvQyxlQUFlUixPQUFRRixJQUFLLENBaENoRCxJQUFBSCxFQUFRRyxLQUFBQSxlQUFZYyxHQUFBQSxhQUFlWiwrQkFDbEM4RCxFQUFLbEQsS0FBZWQsa0JBQXBCSCxHQUNBbUUsRUFBQSxFQXBCRjFGLEtBc0JPb0MsZUFBQVYsR0FBQVAsVUFBQSxHQWlDS25CLEtBQUtvQyxlQUFlVixHQUFHUCxXQUFXdUUsSUEvQjdDMUYsS0FBSzBILGVBQUxoRyxHQUFBUCxVQUFBdUUsR0FJQyxJQUFBLElBQUFoRSxFQUFBLEVBQUFBLEVBQUExQixLQUFBd0MsZUFBQVosT0FBQUYsSUFpQ0cxQixLQUFLd0MsZUFBZWQsR0FBR1AsV0FBV25CLEtBQUsySCxvQkEvQjNDM0gsS0FBSXdDLGVBQVNkLEdBQUVQLFVBQUtlLEtBQUFBIiwiZmlsZSI6IndlYi1ib29rLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImNsYXNzIFdlYkJvb2sge1xuXHRjb25zdHJ1Y3Rvcihib29rQ29udGFpbmVyLCBvcHRpb25zKSB7XG5cdFx0Ly9jb250YWluZXJzXG5cdFx0dGhpcy5fYm9va0NvbnRhaW5lciA9IGJvb2tDb250YWluZXI7XG5cdFx0dGhpcy5fdGV4dENvbnRhaW5lciA9IGJvb2tDb250YWluZXIucXVlcnlTZWxlY3RvcignW2RhdGEtd2ItdGV4dC1jb250YWluZXJdJyk7XG5cdFx0dGhpcy5fdGV4dCA9IGJvb2tDb250YWluZXIucXVlcnlTZWxlY3RvcignW2RhdGEtd2ItdGV4dF0nKTtcblx0XHQvL29wdGlvbnNcblx0XHR0aGlzLl9oZWlnaHQgPSBvcHRpb25zLmhlaWdodDtcblx0XHR0aGlzLl93aWR0aCA9IG9wdGlvbnMubWF4V2lkdGg7XG5cdFx0dGhpcy5fbWFyZ2luWCA9IG9wdGlvbnMubWFyZ2luWD09PXVuZGVmaW5lZCA/IDMwIDogb3B0aW9ucy5tYXJnaW5YO1xuXHRcdHRoaXMuX21hcmdpblkgPSBvcHRpb25zLm1hcmdpblk9PT11bmRlZmluZWQgPyAyMCA6IG9wdGlvbnMubWFyZ2luWTtcblx0XHQvL2luaXQgcG9zaXRpb24sIGNvbCAsY29udGFpbmVyV2lkdGggYW5kIGJvb2ttYXJrXG5cdFx0dGhpcy5fcG9zaXRpb24gPSAwO1xuXHRcdHRoaXMuY29sID0gdHJ1ZTsvL2RlZmF1bHQgdHJ1ZSA9IHRvQm9vaygpXG5cdFx0dGhpcy5fYm9va21hcmsgPSBudWxsO1xuXHRcdHRoaXMuX2NvbnRhaW5lcldpZHRoID0gbnVsbDtcblx0XHQvL3RoaXMubGFzdEJyZWFrIGlzIHVzZWQgYXMgYSBnaG9zdCBwYWdlXG5cdFx0dGhpcy5fbGFzdEJyZWFrID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblx0XHR0aGlzLl9sYXN0QnJlYWsuY2xhc3NOYW1lID0gXCJ3Yi10ZXh0LWJyZWFrXCI7XG5cdFx0dGhpcy5fdGV4dC5hcHBlbmRDaGlsZCh0aGlzLl9sYXN0QnJlYWspO1xuXHRcdC8vdGhpcy5fbGFzdEVsZW1lbnQgaXMgdXNlZCBhcyBsYW5kbWFya1xuXHRcdHRoaXMuX2xhc3RFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblx0XHR0aGlzLl9sYXN0RWxlbWVudC5pbm5lckhUTUwgPSBcIiZuYnNwO1wiOy8vbm90IGVtcHR5IChmb3IgbW96Q29sdW1ucylcblx0XHR0aGlzLl9sYXN0RWxlbWVudC5jbGFzc05hbWUgPSBcIndiLXNlY3Rpb24gd2Itbm8tdG9jXCI7XG5cdFx0dGhpcy5fbGFzdEJyZWFrLmlkID0gJ2xhc3RlbGVtZW50Jztcblx0XHR0aGlzLl90ZXh0LmFwcGVuZENoaWxkKHRoaXMuX2xhc3RFbGVtZW50KTtcblx0XHQvL3NlY3Rpb25zXG5cdFx0dGhpcy5fc2VjdGlvbnMgPSB0aGlzLl90ZXh0LnF1ZXJ5U2VsZWN0b3JBbGwoJy53Yi1zZWN0aW9uJyk7XG5cdFx0Ly9zZWN0aW9ucyB3aXRob3V0IHdiLW5vLXRvY1xuXHRcdHRoaXMuX3RvY1NlY3Rpb25zID0gW11cblx0XHRmb3IobGV0IGk9MDsgaTx0aGlzLl9zZWN0aW9ucy5sZW5ndGg7IGkrKykge1xuXHRcdFx0aWYoIXRoaXMuX3NlY3Rpb25zW2ldLmNsYXNzTmFtZS5tYXRjaCgvd2Itbm8tdG9jLykpIHtcblx0XHRcdFx0dGhpcy5fdG9jU2VjdGlvbnMucHVzaCh0aGlzLl9zZWN0aW9uc1tpXSk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdC8vYnJlYWtzXG5cdFx0dGhpcy5fYnJlYWtzID0gdGhpcy5fdGV4dC5xdWVyeVNlbGVjdG9yQWxsKCcud2ItdGV4dC1icmVhaycpO1xuXHRcdC8vZWxlbWVudHMgOiBzZWxlY3QgYWxsIGVsZW1lbnRzIGJ1dCAudGV4dC1icmVha3MgKGZvciBib29rbWFya3MpXG5cdFx0dGhpcy5fZWxlbWVudHMgPSB0aGlzLl90ZXh0LnF1ZXJ5U2VsZWN0b3JBbGwoJzpub3QoLndiLXRleHQtYnJlYWspJyk7XG5cdFx0Ly90b2Ncblx0XHR0aGlzLl90b2NzID0gdGhpcy5fYm9va0NvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCdbZGF0YS13Yi10b2NdJyk7XG5cdFx0Ly9zZXRUb2MgYmVmb3JlIHF1ZXJ5aW5nIHRoaXMuZWxQYWdlTnVtYmVyc1xuXHRcdHRoaXMuZ2V0VG9jKCk7XG5cdFx0Ly9pbmZvcyBjb250YWluZXJzXG5cdFx0dGhpcy5fY3VycmVudFBhZ2VzID0gdGhpcy5fYm9va0NvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCcud2ItY3VycmVudC1wYWdlJyk7XG5cdFx0dGhpcy5fdG90YWxQYWdlcyA9IHRoaXMuX2Jvb2tDb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnLndiLXRvdGFsLXBhZ2VzJyk7XG5cdFx0dGhpcy5fY3VycmVudFRvdGFsUGFnZXMgPSB0aGlzLl9ib29rQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJy53Yi1jdXJyZW50QnlUb3RhbC1wYWdlcycpO1xuXHRcdHRoaXMuX2VsUGFnZU51bWJlcnMgPSB0aGlzLl9ib29rQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLXdiLWVsZW1lbnQtcGFnZS1udW1iZXJdJyk7XG5cdFx0dGhpcy5fc2VjdGlvblRpdGxlcyA9IHRoaXMuX2Jvb2tDb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnLndiLWN1cnJlbnQtc2VjdGlvbi10aXRsZScpO1xuXHRcdC8vc3RhcnQgcGFnaW5hdGlvblxuXHRcdHRoaXMuX3N0YXJ0UGFnZSA9IG51bGw7XG5cdFx0Ly9saW5rcyA6IHJlcGxhY2UgZGVmYXVsdCB3aXRoIGdvVG9QYWdlXG5cdFx0bGV0IGxpbmtzID0gdGhpcy5fYm9va0NvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCcud2ItbGluaycpO1xuXHRcdFx0XHRcblx0XHRmb3IobGV0IGk9MDsgaTxsaW5rcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0bGlua3NbaV0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBlID0+IHtcblx0XHRcdFx0aWYodGhpcy5jb2w9PT10cnVlKSB7XG5cdFx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRcdGxldCBocmVmID0gZS5jdXJyZW50VGFyZ2V0LmdldEF0dHJpYnV0ZSgnaHJlZicpO1xuXHRcdFx0XHRcdGxldCBpZCA9IGhyZWYucmVwbGFjZSgvXiMvLFwiXCIpO1xuXHRcdFx0XHRcdHRoaXMuZ29Ub1BhZ2UodGhpcy5lbGVtZW50UGFnZU51bWJlcihpZCkpO1xuXHRcdFx0XHR9XG5cdFx0XHR9LCBmYWxzZSlcblx0XHR9XG5cdFx0XG5cdFx0XG5cdFx0aWYoJ1dlYmtpdENvbHVtbldpZHRoJyBpbiBkb2N1bWVudC5ib2R5LnN0eWxlIHx8ICdNb3pDb2x1bW5XaWR0aCcgaW4gZG9jdW1lbnQuYm9keS5zdHlsZSB8fCAnY29sdW1uV2lkdGgnIGluIGRvY3VtZW50LmJvZHkuc3R5bGUpIHtcblx0XHRcdHRoaXMudG9Cb29rKCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMudG9TY3JvbGwoKTtcblx0XHR9XG5cblx0fVxuXG5cdHRvQm9vaygpIHtcblx0XHRpZignd2Via2l0Q29sdW1uV2lkdGgnIGluIGRvY3VtZW50LmJvZHkuc3R5bGUgfHwgJ01vekNvbHVtbldpZHRoJyBpbiBkb2N1bWVudC5ib2R5LnN0eWxlIHx8ICdjb2x1bW5XaWR0aCcgIGluIGRvY3VtZW50LmJvZHkuc3R5bGUpIHtcblx0XHRcdHRoaXMuY29sID0gdHJ1ZTtcblx0XHRcdGxldCBjcyA9IHRoaXMuX3RleHRDb250YWluZXIuc3R5bGU7XG5cdFx0XHRsZXQgdHMgPSB0aGlzLl90ZXh0LnN0eWxlO1xuXHRcdFx0Ly90ZXh0LWNvbnRhaW5lclxuXHRcdFx0Ly9jcy5ib3hTaXppbmcgPSBcImJvcmRlci1ib3hcIjtcblx0XHRcdC8vY3MuV2Via2l0Qm94U2l6aW5nID0gXCJib3JkZXItYm94XCI7XG5cdFx0XHRjcy5wb3NpdGlvbiA9IFwicmVsYXRpdmVcIjtcblx0XHRcdGNzLnBhZGRpbmcgPSBcIjBweFwiO1xuXHRcdFx0Y3MuaGVpZ2h0ID0gdGhpcy5nZXRIZWlnaHQoKSArIFwicHhcIjtcblx0XHRcdGNzLm1heFdpZHRoID0gdGhpcy5nZXRNYXhXaWR0aCgpICsgXCJweFwiOy8vbWF4V2lkdGggOiByZXNwb25zaXZlXG5cdFx0XHR0aGlzLl9jb250YWluZXJXaWR0aCA9IHRoaXMuX3RleHRDb250YWluZXIuY2xpZW50V2lkdGg7Ly9yZXNwb25zaXZlXG5cdFx0XHRcblx0XHRcdC8vc2VjdGlvbnNcblx0XHRcdC8vaGFjayBmaXJlZm94IChwb3VyIG9mZnNldExlZnQpIDogbWluSGVpZ2h0ID0gMTAlXG5cdFx0XHRmb3IobGV0IGk9MDsgaTx0aGlzLl9zZWN0aW9ucy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRpZih0aGlzLl9zZWN0aW9uc1tpXS5zdHlsZS5taW5IZWlnaHQhPT1cIjEwJVwiKSB7XG5cdFx0XHRcdFx0dGhpcy5fc2VjdGlvbnNbaV0uc3R5bGUubWluSGVpZ2h0ID0gXCIxMCVcIjtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0Ly9tYW51YWwgYnJlYWtzXG5cdFx0XHRmb3IobGV0IGk9MDsgaTx0aGlzLl9icmVha3MubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0aWYodGhpcy5fYnJlYWtzW2ldLnN0eWxlLm1hcmdpbkJvdHRvbSE9PVwiMzAwJVwiKSB7XG5cdFx0XHRcdFx0dGhpcy5fYnJlYWtzW2ldLnN0eWxlLm1hcmdpbkJvdHRvbSA9IFwiMzAwJVwiO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHQvL2xhc3QgZWxlbWVudFxuXHRcdFx0aWYodGhpcy5fbGFzdEVsZW1lbnQuc3R5bGUubWFyZ2luQm90dG9tIT09XCIzMDAlXCIpIHtcblx0XHRcdFx0dGhpcy5fbGFzdEVsZW1lbnQuc3R5bGUubWFyZ2luQm90dG9tID0gXCIzMDAlXCI7XG5cdFx0XHR9XG5cblx0XHRcdC8vdGV4dFxuXHRcdFx0Ly90cy5ib3hTaXppbmcgPSBcImJvcmRlci1ib3hcIjtcblx0XHRcdC8vdHMuV2Via2l0Qm94U2l6aW5nID0gXCJib3JkZXItYm94XCI7XHRcdFx0XG5cdFx0XHR0cy53ZWJraXRDb2x1bW5XaWR0aCA9IHRoaXMuX2NvbnRhaW5lcldpZHRoICsgXCJweFwiO1xuXHRcdFx0dHMuTW96Q29sdW1uV2lkdGggPSB0aGlzLl9jb250YWluZXJXaWR0aCArIFwicHhcIjtcblx0XHRcdHRzLmNvbHVtbldpZHRoID0gdGhpcy5fY29udGFpbmVyV2lkdGggKyBcInB4XCI7XG5cdFx0XHR0cy5Nb3pDb2x1bW5HYXAgPSB0aGlzLmdldE1hcmdpblgoKSoyICsgXCJweFwiO1xuXHRcdFx0dHMud2Via2l0Q29sdW1uR2FwID0gdGhpcy5nZXRNYXJnaW5YKCkqMiArIFwicHhcIjtcblx0XHRcdHRzLmNvbHVtbkdhcCA9IHRoaXMuZ2V0TWFyZ2luWCgpKjIgKyBcInB4XCI7XG5cdFx0XHR0cy5Nb3pDb2x1bW5GaWxsID0gXCJhdXRvXCI7Ly9pbXBvcnRhbnQgISEhXG5cdFx0XHR0cy5jb2x1bW5GaWxsID0gXCJhdXRvXCI7Ly9pbXBvcnRhbnQgISEhXG5cdFx0XHR0cy5oZWlnaHQgPSBcIjEwMCVcIjtcblx0XHRcdHRzLndpZHRoID0gXCIxMDAlXCI7XG5cdFx0XHR0cy5wYWRkaW5nUmlnaHQgPSB0aGlzLmdldE1hcmdpblgoKSArIFwicHhcIjtcblx0XHRcdHRzLnBhZGRpbmdMZWZ0ID0gdGhpcy5nZXRNYXJnaW5YKCkgKyBcInB4XCI7XG5cdFx0XHR0cy5wYWRkaW5nVG9wID0gdGhpcy5nZXRNYXJnaW5ZKCkgKyBcInB4XCI7XG5cdFx0XHR0cy5wYWRkaW5nQm90dG9tID0gdGhpcy5nZXRNYXJnaW5ZKCkgKyBcInB4XCI7XG5cdFx0XHR0cy5wb3NpdGlvbiA9IFwiYWJzb2x1dGVcIjtcblx0XHRcdHRzLmxlZnQgPSAwO1xuXHRcdFx0dHMudG9wID0gMDtcblx0XHRcdC8vVGV4dC1jb250YWluZXIgb3ZlcmZsb3cgaGlkZGVuXG5cdFx0XHRjcy5vdmVyZmxvdyA9IFwiaGlkZGVuXCI7XG5cdFx0XHRcblx0XHRcdFxuXHRcdFx0Y29uc29sZS5sb2coJCgnW2RhdGEtd2ItdGV4dF0nKS5wb3NpdGlvbigpKTtcblx0XHRcdHZhciBvZmZzZXRMZWZ0ID0gJCgnI2xhc3RlbGVtZW50JykucG9zaXRpb24oKTtcblx0XHRcdGNvbnNvbGUubG9nKG9mZnNldExlZnQpO1xuXHRcdFx0Y29uc29sZS5sb2codGhpcy5fbGFzdEVsZW1lbnQub2Zmc2V0TGVmdCk7XG5cdFx0XHRcblx0XHRcdC8vR28gdG8gYm9va21hcmtcblx0XHRcdGlmKHRoaXMuX2Jvb2ttYXJrKSB7XG5cdFx0XHRcdHRoaXMuZ29Ub0Jvb2ttYXJrKHRoaXMuX2Jvb2ttYXJrKTtcblx0XHRcdFx0dGhpcy5fcG9zaXRpb24gPSB0aGlzLl90ZXh0Lm9mZnNldExlZnQ7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8vUmVmcmVzaCBpbmZvIGNvbnRhaW5lcnNcblx0XHRcdHRoaXMucmVmcmVzaCgpO1xuXHRcdH1cblx0fVxuXG5cdHRvU2Nyb2xsKCkge1xuXHRcdCd1c2Ugc3RyaWN0Jztcblx0XHR0aGlzLmNvbCA9IGZhbHNlO1xuXHRcdGxldCBjcyA9IHRoaXMuX2NvbnRhaW5lci5zdHlsZTtcblx0XHRsZXQgdHMgPSB0aGlzLl90ZXh0LnN0eWxlO1xuXHRcdC8vY29udGFpbmVyXG5cdFx0Y3MuaGVpZ2h0ID0gXCJhdXRvXCI7XG5cdFx0Y3MubWF4V2lkdGggPSB0aGlzLmdldE1heFdpZHRoKCkgKyBcInB4XCI7XG5cdFx0Y3Mub3ZlcmZsb3cgPSBcInZpc2libGVcIjtcblx0XHQvL3RleHRcblx0XHR0cy5wb3NpdGlvbiA9IFwic3RhdGljXCI7XG5cdFx0dHMuaGVpZ2h0ID0gXCJhdXRvXCI7XG5cdFx0Y3MucGFkZGluZ1JpZ2h0ID0gdGhpcy5nZXRNYXJnaW5YKCkgKyBcInB4XCI7XG5cdFx0Y3MucGFkZGluZ0xlZnQgPSB0aGlzLmdldE1hcmdpblgoKSArIFwicHhcIjtcblx0XHRjcy5wYWRkaW5nVG9wID0gdGhpcy5nZXRNYXJnaW5ZKCkgKyBcInB4XCI7XG5cdFx0Y3MucGFkZGluZ0JvdHRvbSA9IHRoaXMuZ2V0TWFyZ2luWSgpICsgXCJweFwiO1xuXG5cdFx0aWYoJ3dlYmtpdENvbHVtbldpZHRoJyBpbiBkb2N1bWVudC5ib2R5LnN0eWxlIHx8ICdNb3pDb2x1bW5XaWR0aCcgaW4gZG9jdW1lbnQuYm9keS5zdHlsZSB8fCAnY29sdW1uV2lkdGgnICBpbiBkb2N1bWVudC5ib2R5LnN0eWxlKSB7XG5cdFx0XHR0cy53ZWJraXRDb2x1bW5zID0gXCJhdXRvIDFcIjtcblx0XHRcdHRzLk1vekNvbHVtbnMgPSBcImF1dG8gMVwiO1xuXHRcdFx0dHMuY29sdW1ucyA9IFwiYXV0byAxXCI7XG5cdFx0fVxuXHRcdFxuXG5cdFx0Ly9TZWN0aW9ucyAoZm9yIG1vekNvbHVtbnMpXG5cdFx0Zm9yKGxldCBpPTA7IGk8dGhpcy5fc2VjdGlvbnMubGVuZ3RoOyBpKyspIHtcblx0XHRcdHRoaXMuX3NlY3Rpb25zW2ldLnN0eWxlLm1pbkhlaWdodCA9IFwiMFwiO1xuXHRcdH1cblx0XHQvL21hbnVhbCBicmVha3Ncblx0XHRmb3IobGV0IGk9MDsgaTx0aGlzLl9icmVha3MubGVuZ3RoOyBpKyspIHtcblx0XHRcdHRoaXMuX2JyZWFrc1tpXS5zdHlsZS5tYXJnaW5Cb3R0b20gPSBcIjBcIjtcblx0XHR9XG5cdFx0Ly9sYXN0IGVsZW1lbnRcblx0XHR0aGlzLl9sYXN0RWxlbWVudC5zdHlsZS5tYXJnaW5Cb3R0b20gPSBcIjBweFwiO1xuXG5cdFx0dGhpcy5yZWZyZXNoKCk7XG5cdH07XG5cblx0c2V0TWF4V2lkdGgodykge1xuXHRcdHRoaXMuX3dpZHRoID0gdztcblx0XHRyZXR1cm4gdGhpcztcblx0fVxuXG5cdGdldE1heFdpZHRoKCkge1xuXHRcdHJldHVybiB0aGlzLl93aWR0aDtcblx0fVxuXG5cdHNldEhlaWdodChoKSB7XG5cdFx0dGhpcy5faGVpZ2h0ID0gaDtcblx0XHRyZXR1cm4gdGhpcztcblx0fVxuXG5cdGdldEhlaWdodCgpIHtcblx0XHRyZXR1cm4gdGhpcy5faGVpZ2h0O1xuXHR9XG5cblx0c2V0TWFyZ2luWChtKSB7XG5cdFx0dGhpcy5fbWFyZ2luWCA9IG07XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH1cblxuXHRnZXRNYXJnaW5YKCkge1xuXHRcdHJldHVybiB0aGlzLl9tYXJnaW5YO1xuXHR9XG5cblx0c2V0TWFyZ2luWShtKSB7XG5cdFx0dGhpcy5fbWFyZ2luWSA9IG07XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH1cblxuXHRnZXRNYXJnaW5ZKCkge1xuXHRcdHJldHVybiB0aGlzLl9tYXJnaW5ZO1xuXHR9XG5cblx0Zm9yd2FyZCgpIHtcblx0XHRpZih0aGlzLl9sYXN0RWxlbWVudC5vZmZzZXRMZWZ0K3RoaXMuX3Bvc2l0aW9uID4gdGhpcy5fY29udGFpbmVyV2lkdGgrdGhpcy5nZXRNYXJnaW5YKCkpIHtcblx0XHRcdHRoaXMuX3Bvc2l0aW9uID0gdGhpcy5fdGV4dC5vZmZzZXRMZWZ0O1xuXHRcdFx0dGhpcy5fcG9zaXRpb24gLT0gdGhpcy5fY29udGFpbmVyV2lkdGg7XG5cdFx0XHR0aGlzLl90ZXh0LnN0eWxlLmxlZnQgPSB0aGlzLl9wb3NpdGlvbiArIFwicHhcIjtcblx0XHRcdFxuXHRcdFx0dGhpcy5yZWZyZXNoKCk7XG5cdFx0fVxuXHR9XG5cblx0YmFja3dhcmQoKSB7XG5cdFx0aWYodGhpcy5fcG9zaXRpb24gPCAwKSB7XG5cdFx0XHR0aGlzLl9wb3NpdGlvbiA9IHRoaXMuX3RleHQub2Zmc2V0TGVmdDtcblx0XHRcdHRoaXMuX3Bvc2l0aW9uICs9IHRoaXMuX2NvbnRhaW5lcldpZHRoO1xuXHRcdFx0dGhpcy5fdGV4dC5zdHlsZS5sZWZ0ID0gdGhpcy5fcG9zaXRpb24gKyBcInB4XCI7XG5cdFx0XHR0aGlzLnJlZnJlc2goKTtcblx0XHR9XG5cdH1cblxuXHR0b0ZpcnN0UGFnZSgpIHtcblx0XHRpZih0aGlzLl9wb3NpdGlvbiA8IDApIHtcblx0XHRcdHRoaXMuX3Bvc2l0aW9uID0gMDtcblx0XHRcdHRoaXMuX3RleHQuc3R5bGUubGVmdCA9IHRoaXMuX3Bvc2l0aW9uICsgXCJweFwiO1xuXHRcdFx0dGhpcy5yZWZyZXNoKCk7XG5cdFx0fVxuXHR9XG5cblx0dG9MYXN0UGFnZSgpIHtcblx0XHRpZih0aGlzLl9sYXN0RWxlbWVudC5vZmZzZXRMZWZ0K3RoaXMuX3Bvc2l0aW9uID4gdGhpcy5fY29udGFpbmVyV2lkdGgrdGhpcy5nZXRNYXJnaW5YKCkpIHtcblx0XHRcdHRoaXMuX3Bvc2l0aW9uID0gdGhpcy5fY29udGFpbmVyV2lkdGgrdGhpcy5nZXRNYXJnaW5YKCktdGhpcy5fbGFzdEVsZW1lbnQub2Zmc2V0TGVmdDtcblx0XHRcdHRoaXMuX3RleHQuc3R5bGUubGVmdCA9IHRoaXMuX3Bvc2l0aW9uK1wicHhcIjtcblx0XHRcdHRoaXMucmVmcmVzaCgpO1xuXHRcdH1cblx0fVxuXHRcblx0Z2V0UGFnZVN0YXJ0KCkge1xuXHRcdGxldCBpbmRleCwgc3RhcnRJbmRleDtcblx0XHRmb3IobGV0IGk9MDsgaTwgdGhpcy5fc2VjdGlvbnMubGVuZ3RoLTE7IGkrKykge1xuXHRcdFx0aWYodGhpcy5fc2VjdGlvbnNbaV0uY2xhc3NOYW1lLm1hdGNoKC93Yi1uby1wYWdlLykpIHtcblx0XHRcdFx0aW5kZXggPSBpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0aWYoaW5kZXghPT11bmRlZmluZWQgJiYgc3RhcnRJbmRleD09PXVuZGVmaW5lZCkge1xuXHRcdFx0XHRcdHN0YXJ0SW5kZXggPSBpO1xuXHRcdFx0XHRcdGxldCBlbCA9IHRoaXMuX3NlY3Rpb25zW3N0YXJ0SW5kZXhdO1xuXHRcdFx0XHRcdGxldCBlbFBvc2l0aW9uID0gZWwub2Zmc2V0TGVmdCAtIHRoaXMuZ2V0TWFyZ2luWCgpO1xuXHRcdFx0XHRcdGVsUG9zaXRpb24gPSAoZWxQb3NpdGlvbiV0aGlzLl9jb250YWluZXJXaWR0aCE9PTAgPyBlbFBvc2l0aW9uLWVsUG9zaXRpb24ldGhpcy5fY29udGFpbmVyV2lkdGggOiBlbFBvc2l0aW9uKTsvL2Fsd2F5cyBhdCBhIHBhZ2UgYmVnaW5uaW5nXG5cdFx0XHRcdFx0dGhpcy5fc3RhcnRQYWdlID0gZWxQb3NpdGlvbi90aGlzLl9jb250YWluZXJXaWR0aDtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fVxuXHRcblx0Y2hlY2tGaXJzdFBhZ2UoKSB7XG5cdFx0bGV0IGNoZWNrID0gdGhpcy5fcG9zaXRpb249PT0wID8gdHJ1ZSA6IGZhbHNlO1xuXHRcdHJldHVybiBjaGVjaztcblx0fVxuXG5cdGdldFBhZ2VOdW1iZXIoKSB7XG5cdFx0Ly90aGlzLl9wb3NpdGlvbi90aGlzLl9jb250YWluZXJXaWR0aCBpcyBzdGFydCBvZiBhIHBhZ2UgOiBzdGFydCAwIGlzIHBhZ2UgMSwuLi4gKHNvIDogKzEpXG5cdFx0bGV0IHBhZ2VOdW1iZXIgPSBNYXRoLmFicyhNYXRoLmZsb29yKHRoaXMuX3Bvc2l0aW9uL3RoaXMuX2NvbnRhaW5lcldpZHRoKSkrMTtcblx0XHQvL3RoaXMuX3N0YXJ0UGFnZSAocGFnaW5hdGlvbiBzdGFydClcblx0XHRwYWdlTnVtYmVyID0gcGFnZU51bWJlci0odGhpcy5fc3RhcnRQYWdlKTtcblx0XHRyZXR1cm4gcGFnZU51bWJlcjtcblx0fVxuXG5cdGdldFRvdGFsUGFnZXMoKSB7XG5cdFx0bGV0IHRvdGFsUGFnZXMgPSBNYXRoLmZsb29yKHRoaXMuX2xhc3RFbGVtZW50Lm9mZnNldExlZnQvdGhpcy5fY29udGFpbmVyV2lkdGgpO1xuXHRcdHRvdGFsUGFnZXMgPSB0b3RhbFBhZ2VzLSh0aGlzLl9zdGFydFBhZ2UpO1xuXHRcdHJldHVybiB0b3RhbFBhZ2VzO1xuXHR9XG5cblx0Z29Ub1BhZ2UobnVtYmVyKSB7XG5cdFx0bnVtYmVyID0gKG51bWJlcjwxLSh0aGlzLl9zdGFydFBhZ2UpID8gMS0odGhpcy5fc3RhcnRQYWdlKSA6IG51bWJlcik7XG5cdFx0bnVtYmVyPSAobnVtYmVyPnRoaXMuZ2V0VG90YWxQYWdlcygpID8gdGhpcy5nZXRUb3RhbFBhZ2VzKCkgOiBudW1iZXIpO1xuXHRcdG51bWJlciA9IG51bWJlciArICh0aGlzLl9zdGFydFBhZ2UpO1xuXHRcdGxldCBwb3NpdGlvbiA9IHRoaXMuX2NvbnRhaW5lcldpZHRoKihudW1iZXItMSk7XG5cdFx0dGhpcy5fdGV4dC5zdHlsZS5sZWZ0ID0gLXBvc2l0aW9uICsgXCJweFwiO1xuXHRcdHRoaXMuX3Bvc2l0aW9uID0gdGhpcy5fdGV4dC5vZmZzZXRMZWZ0O1xuXHRcdHRoaXMucmVmcmVzaCgpO1xuXHR9XG5cblx0ZWxlbWVudFBhZ2VOdW1iZXIoaWQpIHtcblx0XHRsZXQgZWwgPSB0aGlzLl90ZXh0LnF1ZXJ5U2VsZWN0b3IoJyMnICsgaWQpO1xuXHRcdGxldCBlbFBvc2l0aW9uID0gZWwub2Zmc2V0TGVmdCAtIHRoaXMuZ2V0TWFyZ2luWCgpO1xuXHRcdGVsUG9zaXRpb24gPSAoZWxQb3NpdGlvbiV0aGlzLl9jb250YWluZXJXaWR0aCE9PTAgPyBlbFBvc2l0aW9uLWVsUG9zaXRpb24ldGhpcy5fY29udGFpbmVyV2lkdGggOiBlbFBvc2l0aW9uKTsvL2Fsd2F5cyBhdCBhIHBhZ2UgYmVnaW5uaW5nXG5cdFx0bGV0IGVsUGFnZU51bWJlciA9IGVsUG9zaXRpb24vdGhpcy5fY29udGFpbmVyV2lkdGggKyAxOy8vZWxQb3NpdGlvbi90aGlzLl9jb250YWluZXJXaWR0aCBpcyBwb3NpdGlvbiBvZiBhIHBhZ2UgOiBwb3NpdGlvbiAwIGlzIHBhZ2UgMSwuLi5cblx0XHRlbFBhZ2VOdW1iZXIgPSBlbFBhZ2VOdW1iZXItKHRoaXMuX3N0YXJ0UGFnZSk7XG5cdFx0cmV0dXJuIGVsUGFnZU51bWJlcjtcblx0fVxuXG5cdGdldFNlY3Rpb25UaXRsZSgpIHtcblx0XHRsZXQgcG9zaXRpb24gPSAtdGhpcy5fcG9zaXRpb247XG5cdFx0bGV0IHRpdGxlO1xuXHRcdGZvcihsZXQgaT0xOyBpPHRoaXMuX3NlY3Rpb25zLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRpZih0aGlzLl9zZWN0aW9uc1tpXS5vZmZzZXRMZWZ0LXRoaXMuX2NvbnRhaW5lcldpZHRoPj1wb3NpdGlvbikge1xuXHRcdFx0XHRsZXQgaWQgPSB0aGlzLl9zZWN0aW9uc1tpLTFdLmlkO1xuXHRcdFx0XHRpZihpZCE9PXVuZGVmaW5lZCAmJiB0aGlzLmdldFBhZ2VOdW1iZXIoKSA9PT0gdGhpcy5lbGVtZW50UGFnZU51bWJlcihpZCkpIHtcblx0XHRcdFx0XHR0aXRsZSA9IFwiXCI7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0dGl0bGUgPSB0aGlzLl9zZWN0aW9uc1tpLTFdLmdldEF0dHJpYnV0ZSgnZGF0YS13Yi10aXRsZScpID8gdGhpcy5fc2VjdGlvbnNbaS0xXS5nZXRBdHRyaWJ1dGUoJ2RhdGEtd2ItdGl0bGUnKSA6IHRoaXMuX3NlY3Rpb25zW2ktMV0udGl0bGU7XG5cdFx0XHRcdH1cblx0XHRcdFx0YnJlYWs7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiB0aXRsZTtcblx0fVxuXHRcblx0Z2V0VG9jKCkge1xuXHRcdGlmKHRoaXMuX3RvY3MubGVuZ3RoPT09MCkgeyByZXR1cm47IH1cblx0XHRcblx0XHRmb3IobGV0IGk9MDsgaTx0aGlzLl90b2NzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRsZXQgdG9jID0gdGhpcy5fdG9jc1tpXTtcblx0XHRcdGlmKHRvYy5nZXRBdHRyaWJ1dGUoJ2RhdGEtd2ItdG9jJykpIHtcblx0XHRcdFx0bGV0IHRvY1RpdGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuXHRcdFx0XHR0b2NUaXRsZS5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywnd2ItdG9jLXRpdGxlJyk7XG5cdFx0XHRcdHRvY1RpdGxlLmlubmVySFRNTCA9IHRvYy5nZXRBdHRyaWJ1dGUoJ2RhdGEtd2ItdG9jJyk7XG5cdFx0XHRcdHRvYy5hcHBlbmRDaGlsZCh0b2NUaXRsZSk7XG5cdFx0XHR9XG5cdFx0XHRsZXQgbGlzdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3VsJyk7XG5cdFx0XHRsaXN0LnNldEF0dHJpYnV0ZSgnY2xhc3MnLCd3Yi10b2MtbGlzdCcpO1xuXHRcdFx0Zm9yKGxldCBqPTA7IGo8dGhpcy5fc2VjdGlvbnMubGVuZ3RoOyBqKyspIHtcblx0XHRcdFx0bGV0IHNlY3Rpb24gPSB0aGlzLl9zZWN0aW9uc1tqXTtcblx0XHRcdFx0aWYoIXNlY3Rpb24uY2xhc3NOYW1lLm1hdGNoKC93Yi1uby10b2MvKSkge1xuXHRcdFx0XHRcdGxldCBpdGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcblx0XHRcdFx0XHRpdGVtLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCd3Yi10b2MtaXRlbScpO1xuXHRcdFx0XHRcdGlmKCFzZWN0aW9uLmNsYXNzTmFtZS5tYXRjaCgvd2ItdG9jLW5vLXBhZ2UtbnVtYmVyLykpIHtcblx0XHRcdFx0XHRcdGxldCBsaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xuXHRcdFx0XHRcdFx0bGluay5zZXRBdHRyaWJ1dGUoJ2hyZWYnLCAnIycgKyBzZWN0aW9uLmlkKTtcblx0XHRcdFx0XHRcdGxpbmsuc2V0QXR0cmlidXRlKCdjbGFzcycsICd3Yi1saW5rJyk7XG5cdFx0XHRcdFx0XHRpdGVtLmFwcGVuZENoaWxkKGxpbmspO1xuXHRcdFx0XHRcdFx0bGV0IHRpdGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuXHRcdFx0XHRcdFx0dGl0bGUuc2V0QXR0cmlidXRlKCdjbGFzcycsJ3diLXRvYy1pdGVtLXRpdGxlJyk7XG5cdFx0XHRcdFx0XHR0aXRsZS5pbm5lckhUTUwgPSBzZWN0aW9uLmdldEF0dHJpYnV0ZSgnZGF0YS13Yi10aXRsZS10b2MnKSA/IHNlY3Rpb24uZ2V0QXR0cmlidXRlKCdkYXRhLXdiLXRpdGxlLXRvYycpIDogc2VjdGlvbi50aXRsZTtcblx0XHRcdFx0XHRcdGxpbmsuYXBwZW5kQ2hpbGQodGl0bGUpO1xuXHRcdFx0XHRcdFx0bGV0IHBhZ2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG5cdFx0XHRcdFx0XHRwYWdlLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCd3Yi10b2MtaXRlbS1wYWdlLW51bWJlcicpO1x0XG5cdFx0XHRcdFx0XHRwYWdlLnNldEF0dHJpYnV0ZSgnZGF0YS13Yi1lbGVtZW50LXBhZ2UtbnVtYmVyJywgc2VjdGlvbi5pZCk7XG5cdFx0XHRcdFx0XHRsaW5rLmFwcGVuZENoaWxkKHBhZ2UpO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRsZXQgdGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG5cdFx0XHRcdFx0XHR0aXRsZS5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywnd2ItdG9jLWl0ZW0tdGl0bGUnKTtcblx0XHRcdFx0XHRcdHRpdGxlLmlubmVySFRNTCA9IHNlY3Rpb24uZ2V0QXR0cmlidXRlKCdkYXRhLXdiLXRpdGxlLXRvYycpID8gc2VjdGlvbi5nZXRBdHRyaWJ1dGUoJ2RhdGEtd2ItdGl0bGUtdG9jJykgOiBzZWN0aW9uLnRpdGxlO1xuXHRcdFx0XHRcdFx0aXRlbS5hcHBlbmRDaGlsZCh0aXRsZSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGxpc3QuYXBwZW5kQ2hpbGQoaXRlbSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdHRvYy5hcHBlbmRDaGlsZChsaXN0KTtcblx0XHR9XG5cdH1cblx0XG5cdGdldFRvY0N1cnJlbnRTZWN0aW9uKCkge1xuXHRcdGxldCBwb3NpdGlvbiA9IC10aGlzLl9wb3NpdGlvbjtcblx0XHR0aGlzLl90b2NTZWN0aW9ucy5wdXNoKHRoaXMuX2xhc3RFbGVtZW50KTtcblx0XHRpZih0aGlzLl9zZWN0aW9uc1swXS5jbGFzc05hbWUubWF0Y2goL3diLW5vLXRvYy8pKSB7XG5cdFx0XHR0aGlzLl90b2NTZWN0aW9ucy51bnNoaWZ0KHRoaXMuX3NlY3Rpb25zWzBdKTtcblx0XHR9XG5cdFx0Zm9yKGxldCBpPTA7IGk8dGhpcy5fdG9jcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0bGV0IHRvYyA9IHRoaXMuX3RvY3NbaV07XG5cdFx0XHRmb3IobGV0IGk9MTsgaTx0aGlzLl90b2NTZWN0aW9ucy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRpZih0aGlzLl90b2NTZWN0aW9uc1tpXS5vZmZzZXRMZWZ0LXRoaXMuX2NvbnRhaW5lcldpZHRoPj1wb3NpdGlvbikge1xuXHRcdFx0XHRcdGxldCBpZCA9IHRoaXMuX3RvY1NlY3Rpb25zW2ktMV0uaWQ7XG5cdFx0XHRcdFx0bGV0IGxpbmtzID0gdG9jLnF1ZXJ5U2VsZWN0b3JBbGwoJ2EnKTtcblx0XHRcdFx0XHRmb3IobGV0IGo9MDsgajxsaW5rcy5sZW5ndGg7IGorKykge1xuXHRcdFx0XHRcdFx0bGV0IGxpbmsgPSBsaW5rc1tqXTtcblx0XHRcdFx0XHRcdGlmKGxpbmsuZ2V0QXR0cmlidXRlKCdocmVmJykucmVwbGFjZSgvXiMvLCcnKSA9PT0gaWQpIHtcblx0XHRcdFx0XHRcdFx0aWYoIWxpbmsucGFyZW50RWxlbWVudC5jbGFzc05hbWUubWF0Y2goL2N1cnJlbnQvKSkge1xuXHRcdFx0XHRcdFx0XHRcdGxpbmsucGFyZW50RWxlbWVudC5jbGFzc05hbWUrPScgY3VycmVudCc7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdGlmKGxpbmsucGFyZW50RWxlbWVudC5jbGFzc05hbWUubWF0Y2goL2N1cnJlbnQvKSkge1xuXHRcdFx0XHRcdFx0XHRcdGxpbmsucGFyZW50RWxlbWVudC5jbGFzc05hbWU9bGluay5wYXJlbnRFbGVtZW50LmNsYXNzTmFtZS5yZXBsYWNlKC8gY3VycmVudC8sJycpO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRcblx0XHR9XG5cdFx0dGhpcy5fdG9jU2VjdGlvbnMucG9wKHRoaXMuX2xhc3RFbGVtZW50KTtcblx0XHRpZih0aGlzLl9zZWN0aW9uc1swXS5jbGFzc05hbWUubWF0Y2goL3diLW5vLXRvYy8pKSB7XG5cdFx0XHR0aGlzLl90b2NTZWN0aW9ucy5zaGlmdCh0aGlzLl9zZWN0aW9uc1swXSk7XG5cdFx0fVxuXHR9XG5cblx0aW5zZXJ0Qm9va21hcmsoKSB7XG5cdFx0bGV0IGJvb2ttYXJrID0gbnVsbDtcblx0XHRmb3IobGV0IGk9MDsgaTx0aGlzLl9lbGVtZW50cy5sZW5ndGg7IGkrKykge1xuXHRcdFx0bGV0IGVsUG9zaXRpb24gPSB0aGlzLl9lbGVtZW50c1tpXS5vZmZzZXRMZWZ0LXRoaXMuZ2V0TWFyZ2luWCgpO1xuXHRcdFx0ZWxQb3NpdGlvbiA9IChlbFBvc2l0aW9uJXRoaXMuX2NvbnRhaW5lcldpZHRoIT09MCA/IGVsUG9zaXRpb24tZWxQb3NpdGlvbiV0aGlzLl9jb250YWluZXJXaWR0aCA6IGVsUG9zaXRpb24pOy8vYWx3YXlzIGF0IGEgcGFnZSBiZWdpbm5pbmdcblx0XHRcdGlmKGVsUG9zaXRpb24gPT09IC10aGlzLl9wb3NpdGlvbilcblx0XHRcdHtcblx0XHRcdFx0Ym9va21hcmsgPSBpO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdH1cblx0XHRcdGVsc2UgaWYoZWxQb3NpdGlvbiA+IC10aGlzLl9wb3NpdGlvbilcblx0XHRcdHtcblx0XHRcdFx0Ym9va21hcmsgPSBpLTE7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXHRcdH1cblx0XHR0aGlzLl9ib29rbWFyayA9IGJvb2ttYXJrO1xuXHR9XG5cblx0Z29Ub0Jvb2ttYXJrKGJvb2ttYXJrKSB7XG5cdFx0bGV0IGVsZW1lbnQgPSB0aGlzLl9lbGVtZW50c1t0aGlzLl9ib29rbWFya107XG5cdFx0Ly9wb3NpdGlvbiA6IG9mZnNldExlZnQgb2YgZWxlbWVudCByZWxhdGl2ZSB0byB0ZXh0XG5cdFx0bGV0IHBvc2l0aW9uID0gZWxlbWVudC5vZmZzZXRMZWZ0LXRoaXMuZ2V0TWFyZ2luWCgpO1xuXHRcdHBvc2l0aW9uID0gKHBvc2l0aW9uJXRoaXMuX2NvbnRhaW5lcldpZHRoIT09MCA/IHBvc2l0aW9uLXBvc2l0aW9uJXRoaXMuX2NvbnRhaW5lcldpZHRoIDogcG9zaXRpb24pOy8vYWx3YXlzIGF0IGEgcGFnZSBiZWdpbm5pbmdcblx0XHQvL3RleHQgcG9zaXRpb24gPSAtcG9zaXRpb25cblx0XHR0aGlzLl90ZXh0LnN0eWxlLmxlZnQgPSAtcG9zaXRpb24gKyBcInB4XCI7XG5cdFx0dGhpcy5fcG9zaXRpb24gPSB0aGlzLl90ZXh0Lm9mZnNldExlZnQ7XG5cdFx0dGhpcy5yZWZyZXNoKCk7XG5cdH1cblxuXHRyZWZyZXNoKCkge1xuXHRcdHRoaXMuaW5zZXJ0Qm9va21hcmsoKTtcblxuXHRcdGlmKHRoaXMuY29sPT09ZmFsc2UpIHtcblx0XHRcdFxuXHRcdFx0Zm9yKGxldCBpPTA7IGk8dGhpcy5fY3VycmVudFBhZ2VzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdHRoaXMuX2N1cnJlbnRQYWdlc1tpXS5pbm5lckhUTUwgPSBcIlwiO1xuXHRcdFx0fVxuXG5cdFx0XHRmb3IobGV0IGk9MDsgaTx0aGlzLl90b3RhbFBhZ2VzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdHRoaXMuX3RvdGFsUGFnZXNbaV0uaW5uZXJIVE1MID0gXCJcIjtcblx0XHRcdH1cblxuXHRcdFx0Zm9yKGxldCBpPTA7IGk8dGhpcy5fY3VycmVudFRvdGFsUGFnZXMubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0dGhpcy5fY3VycmVudFRvdGFsUGFnZXNbaV0uaW5uZXJIVE1MID0gXCJcIjtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Zm9yKGxldCBpPTA7IGk8dGhpcy5fZWxQYWdlTnVtYmVycy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHR0aGlzLl9lbFBhZ2VOdW1iZXJzW2ldLmlubmVySFRNTCA9IFwiXCI7XG5cdFx0XHR9XG5cblx0XHRcdGZvcihsZXQgaT0wOyBpPHRoaXMuX3NlY3Rpb25UaXRsZXMubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0dGhpcy5fc2VjdGlvblRpdGxlc1tpXS5pbm5lckhUTUwgPSBcIlwiO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0fSBlbHNlIHtcblx0XHRcdFxuXHRcdFx0dGhpcy5nZXRQYWdlU3RhcnQoKTtcblx0XHRcdFxuXHRcdFx0aWYodGhpcy5fdG9jcy5sZW5ndGghPT0wKSB7XG5cdFx0XHRcdHRoaXMuZ2V0VG9jQ3VycmVudFNlY3Rpb24oKTtcblx0XHRcdH1cdFxuXHRcdFx0XG5cdFx0XHRmb3IobGV0IGk9MDsgaTx0aGlzLl9jdXJyZW50UGFnZXMubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0aWYodGhpcy5fY3VycmVudFBhZ2VzW2ldLmlubmVySFRNTCE9dGhpcy5nZXRQYWdlTnVtYmVyKCkpIHtcblx0XHRcdFx0XHR0aGlzLl9jdXJyZW50UGFnZXNbaV0uaW5uZXJIVE1MID0gdGhpcy5nZXRQYWdlTnVtYmVyKCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Zm9yKGxldCBpPTA7IGk8dGhpcy5fdG90YWxQYWdlcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRpZih0aGlzLl90b3RhbFBhZ2VzW2ldLmlubmVySFRNTCE9dGhpcy5nZXRQYWdlTnVtYmVyKCkpIHtcblx0XHRcdFx0XHR0aGlzLl90b3RhbFBhZ2VzW2ldLmlubmVySFRNTCA9IHRoaXMuZ2V0UGFnZU51bWJlcigpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdGZvcihsZXQgaT0wOyBpPHRoaXMuX2N1cnJlbnRUb3RhbFBhZ2VzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdGlmKHRoaXMuZ2V0UGFnZU51bWJlcigpIDwgMSkge1xuXHRcdFx0XHRcdHRoaXMuX2N1cnJlbnRUb3RhbFBhZ2VzW2ldLmlubmVySFRNTCA9IFwiXCI7XG5cdFx0XHRcdH0gZWxzZSBpZih0aGlzLl9jdXJyZW50VG90YWxQYWdlc1tpXS5pbm5lckhUTUwhPT0gdGhpcy5nZXRQYWdlTnVtYmVyKCkgKyBcIi9cIiArIHRoaXMuZ2V0VG90YWxQYWdlcygpKSB7XG5cdFx0XHRcdFx0dGhpcy5fY3VycmVudFRvdGFsUGFnZXNbaV0uaW5uZXJIVE1MID0gdGhpcy5nZXRQYWdlTnVtYmVyKCkgKyBcIi9cIiArIHRoaXMuZ2V0VG90YWxQYWdlcygpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdGZvcihsZXQgaT0wOyBpPHRoaXMuX2VsUGFnZU51bWJlcnMubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0bGV0IGlkID0gdGhpcy5fZWxQYWdlTnVtYmVyc1tpXS5nZXRBdHRyaWJ1dGUoJ2RhdGEtd2ItZWxlbWVudC1wYWdlLW51bWJlcicpO1xuXHRcdFx0XHRsZXQgcGFnZU51bWJlciA9IHRoaXMuZWxlbWVudFBhZ2VOdW1iZXIoaWQpO1xuXHRcdFx0XHRpZihwYWdlTnVtYmVyIDwgMSkge1xuXHRcdFx0XHRcdHRoaXMuX2VsUGFnZU51bWJlcnNbaV0uaW5uZXJIVE1MID0gXCJcIjtcblx0XHRcdFx0fSBlbHNlIGlmKHRoaXMuX2VsUGFnZU51bWJlcnNbaV0uaW5uZXJIVE1MIT1wYWdlTnVtYmVyKSB7XG5cdFx0XHRcdFx0dGhpcy5fZWxQYWdlTnVtYmVyc1tpXS5pbm5lckhUTUwgPSBwYWdlTnVtYmVyO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGZvcihsZXQgaT0wOyBpPHRoaXMuX3NlY3Rpb25UaXRsZXMubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0aWYodGhpcy5fc2VjdGlvblRpdGxlc1tpXS5pbm5lckhUTUwhPXRoaXMuZ2V0U2VjdGlvblRpdGxlKCkpIHtcblx0XHRcdFx0XHR0aGlzLl9zZWN0aW9uVGl0bGVzW2ldLmlubmVySFRNTCA9IHRoaXMuZ2V0U2VjdGlvblRpdGxlKCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdH1cblx0fVxufVxuXG4iXX0=
